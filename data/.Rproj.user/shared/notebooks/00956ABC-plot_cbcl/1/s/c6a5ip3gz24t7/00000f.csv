"0","pred_classes_argmax <- max.col(pred_probs_calib) - 1  # assumes labels 0,1,2"
"0",""
"0","y_true_calib <- factor(y_calib, levels = class_labels)"
"0","y_pred_calib <- factor(pred_classes_argmax, levels = class_labels)"
"0",""
"0","conf_matrix <- confusionMatrix(y_pred_calib, y_true_calib)"
"0","print(conf_matrix)"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","   0"
"1","   1"
"1","   2"
"1","
         0"
"1"," 921"
"1","  28"
"1","  19"
"1","
         1"
"1","   1"
"1","   0"
"1","   0"
"1","
         2"
"1","   0"
"1","   0"
"1","   0"
"1","
"
"1","
Overall Statistics
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.9505          "
"1","
"
"1","                 95% CI :"
"1"," (0.9349, 0.9633)"
"1","
"
"1","    No Information Rate :"
"1"," 0.9515          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 0.597           "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," -0.0016         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," NA              "
"1","
"
"1","
Statistics by Class:

"
"1","                    "
"1"," Class: 0"
"1"," Class: 1"
"1"," Class: 2"
"1","
Sensitivity         "
"1","   0.9989"
"1"," 0.000000"
"1","  0.00000"
"1","
Specificity         "
"1","   0.0000"
"1"," 0.998937"
"1","  1.00000"
"1","
Pos Pred Value      "
"1","   0.9514"
"1"," 0.000000"
"1","      NaN"
"1","
Neg Pred Value      "
"1","   0.0000"
"1"," 0.971074"
"1","  0.98039"
"1","
Prevalence          "
"1","   0.9515"
"1"," 0.028896"
"1","  0.01961"
"1","
Detection Rate      "
"1","   0.9505"
"1"," 0.000000"
"1","  0.00000"
"1","
Detection Prevalence"
"1","   0.9990"
"1"," 0.001032"
"1","  0.00000"
"1","
Balanced Accuracy   "
"1","   0.4995"
"1"," 0.499469"
"1","  0.50000"
"1","
"
