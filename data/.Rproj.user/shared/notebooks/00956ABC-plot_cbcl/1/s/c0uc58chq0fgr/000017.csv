"0",""
"0","# Prepare data for plotting"
"0","hist_data <- data.frame(stat = perm_accs)"
"0",""
"0","# Compute density for accurate y-positioning"
"0","dens <- density(perm_accs)"
"0","y_pos <- max(dens$y) * 0.95  # Slightly below the peak for visibility"
"0",""
"0","# Improved plot with fixed label position"
"0","perm_plot <- ggplot(hist_data, aes(x = stat)) +"
"0","  geom_density(fill = ""#2E8B57"", alpha = 0.4) +"
"0","  geom_vline(xintercept = observed_acc, color = ""blue"", size = 1.2) +"
"0","  annotate(""text"", x = observed_acc, y = y_pos,"
"0","           label = ""Observed accuracy"", hjust = -0.1, vjust = 1, color = ""blue"", size = 4) +"
"0","  labs("
"0","    title = ""Permutation Test: Model Accuracy vs. Null Distribution"","
"0","    subtitle = ""Null distribution of accuracy under label permutation"","
"0","    x = ""Classification Accuracy"","
"0","    y = ""Density"","
"0","    caption = ""Green line: Accuracy on true labels\nBlue area: Distribution under random label permutations"""
"0","  ) +"
"0","  theme_classic(base_size = 14) +"
"0","  theme("
"0","    plot.title = element_text(face = ""bold"", size = 16),"
"0","    plot.subtitle = element_text(size = 12),"
"0","    plot.caption = element_text(size = 10, hjust = 0, color = ""gray30"")"
"0","  )"
"0",""
"0",""
"0","print(perm_plot)"
