"0","#results_df <- read.csv(""/Users/maggieheimvik/Desktop/GitHub/masters_thesis/Data/ocd//outputs/models/multiclass_cbcl_bpm/bpm_external_hyperparameter_tuning_results.csv"")"
"0",""
"0","#load(""/Users/maggieheimvik/Desktop/GitHub/masters_thesis/Data/ocd/outputs/models/multiclass_cbcl_bpm/m_bpm_i_model+preds.RData"")"
"0","#xgboost test matrix "
"0","dcalib <- xgb.DMatrix(data = x_calib, label = y_calib)"
"0",""
"0","#train final best model"
"0","final_model <- xgb.train("
"0","  params = params,"
"0","  data = dtrain,"
"0","  nrounds = best_nrounds,"
"0","  watchlist = list(train = dtrain, eval = dcalib),"
"0","  verbose = 1"
"0",")"
"1","[1]	train-mlogloss:0.990669	eval-mlogloss:1.002195"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.894811	eval-mlogloss:0.922443"
"1"," "
"1","
"
"1","[3]	train-mlogloss:0.805158	eval-mlogloss:0.841654"
"1"," "
"1","
"
"1","[4]	train-mlogloss:0.734937	eval-mlogloss:0.775649"
"1"," "
"1","
"
"1","[5]	train-mlogloss:0.673932	eval-mlogloss:0.715377"
"1"," "
"1","
"
"1","[6]	train-mlogloss:0.612222	eval-mlogloss:0.659057"
"1"," "
"1","
"
"1","[7]	train-mlogloss:0.561445	eval-mlogloss:0.615265"
"1"," "
"1","
"
"1","[8]	train-mlogloss:0.516724	eval-mlogloss:0.573162"
"1"," "
"1","
"
"1","[9]	train-mlogloss:0.476951	eval-mlogloss:0.532775"
"1"," "
"1","
"
"1","[10]	train-mlogloss:0.438310	eval-mlogloss:0.495594"
"1"," "
"1","
"
"1","[11]	train-mlogloss:0.404369	eval-mlogloss:0.465059"
"1"," "
"1","
"
"1","[12]	train-mlogloss:0.371624	eval-mlogloss:0.435519"
"1"," "
"1","
"
"1","[13]	train-mlogloss:0.341613	eval-mlogloss:0.409239"
"1"," "
"1","
"
"1","[14]	train-mlogloss:0.316002	eval-mlogloss:0.383588"
"1"," "
"1","
"
"1","[15]	train-mlogloss:0.292549	eval-mlogloss:0.361801"
"1"," "
"1","
"
"1","[16]	train-mlogloss:0.271135	eval-mlogloss:0.342094"
"1"," "
"1","
"
"1","[17]	train-mlogloss:0.251570	eval-mlogloss:0.324844"
"1"," "
"1","
"
"1","[18]	train-mlogloss:0.232658	eval-mlogloss:0.307651"
"1"," "
"1","
"
"1","[19]	train-mlogloss:0.216238	eval-mlogloss:0.293016"
"1"," "
"1","
"
"1","[20]	train-mlogloss:0.200262	eval-mlogloss:0.279081"
"1"," "
"1","
"
"1","[21]	train-mlogloss:0.186363	eval-mlogloss:0.266837"
"1"," "
"1","
"
"1","[22]	train-mlogloss:0.174733	eval-mlogloss:0.258220"
"1"," "
"1","
"
"1","[23]	train-mlogloss:0.162230	eval-mlogloss:0.248424"
"1"," "
"1","
"
"1","[24]	train-mlogloss:0.151848	eval-mlogloss:0.239122"
"1"," "
"1","
"
"1","[25]	train-mlogloss:0.141880	eval-mlogloss:0.231015"
"1"," "
"1","
"
"1","[26]	train-mlogloss:0.133113	eval-mlogloss:0.223579"
"1"," "
"1","
"
"1","[27]	train-mlogloss:0.124477	eval-mlogloss:0.216129"
"1"," "
"1","
"
"1","[28]	train-mlogloss:0.116858	eval-mlogloss:0.210071"
"1"," "
"1","
"
"1","[29]	train-mlogloss:0.109783	eval-mlogloss:0.204392"
"1"," "
"1","
"
"1","[30]	train-mlogloss:0.103074	eval-mlogloss:0.199201"
"1"," "
"1","
"
"1","[31]	train-mlogloss:0.097489	eval-mlogloss:0.194792"
"1"," "
"1","
"
"1","[32]	train-mlogloss:0.092203	eval-mlogloss:0.190510"
"1"," "
"1","
"
"1","[33]	train-mlogloss:0.087215	eval-mlogloss:0.186589"
"1"," "
"1","
"
"1","[34]	train-mlogloss:0.082230	eval-mlogloss:0.182535"
"1"," "
"1","
"
"1","[35]	train-mlogloss:0.077903	eval-mlogloss:0.178804"
"1"," "
"1","
"
"1","[36]	train-mlogloss:0.074182	eval-mlogloss:0.175379"
"1"," "
"1","
"
"1","[37]	train-mlogloss:0.070650	eval-mlogloss:0.172250"
"1"," "
"1","
"
"1","[38]	train-mlogloss:0.067529	eval-mlogloss:0.169341"
"1"," "
"1","
"
"1","[39]	train-mlogloss:0.064072	eval-mlogloss:0.166655"
"1"," "
"1","
"
"1","[40]	train-mlogloss:0.061623	eval-mlogloss:0.164979"
"1"," "
"1","
"
"1","[41]	train-mlogloss:0.058892	eval-mlogloss:0.163106"
"1"," "
"1","
"
"1","[42]	train-mlogloss:0.056604	eval-mlogloss:0.161698"
"1"," "
"1","
"
"1","[43]	train-mlogloss:0.054196	eval-mlogloss:0.159613"
"1"," "
"1","
"
"1","[44]	train-mlogloss:0.051932	eval-mlogloss:0.158087"
"1"," "
"1","
"
"1","[45]	train-mlogloss:0.049880	eval-mlogloss:0.156993"
"1"," "
"1","
"
"1","[46]	train-mlogloss:0.048096	eval-mlogloss:0.156242"
"1"," "
"1","
"
"1","[47]	train-mlogloss:0.046341	eval-mlogloss:0.154960"
"1"," "
"1","
"
"1","[48]	train-mlogloss:0.044631	eval-mlogloss:0.153799"
"1"," "
"1","
"
"1","[49]	train-mlogloss:0.043082	eval-mlogloss:0.152575"
"1"," "
"1","
"
"1","[50]	train-mlogloss:0.041875	eval-mlogloss:0.151561"
"1"," "
"1","
"
"0","# predict on calibration set "
"0","pred_probs <- predict(final_model, dcalib, reshape = TRUE, outputmargin = FALSE)"
"0","colnames(pred_probs) <- class_labels"
"0","#argmax"
"0","pred_classes_argmax <- max.col(pred_probs) - 1  # match class labels 0,1,2"
