"0","# Add trial number"
"0","results_df$Trial <- seq_len(nrow(results_df))"
"0","results_df$best_so_far <- cummin(results_df$mlogloss)"
"0",""
"0","# Plot"
"0","p2 <- ggplot(results_df, aes(x = Trial, y = mlogloss)) +"
"0","  # Actual points, colored by log loss"
"0","  geom_point(aes(color = mlogloss), size = 2, alpha = 0.8) +"
"0","  # Red best model line"
"0","  geom_line(aes(y = best_so_far, linetype = ""Best Model""), color = ""red"", size = 1, show.legend = TRUE) +"
"0","  # Dummy shape layer for legend"
"0","  geom_point(aes(shape = ""Trial Log Loss""), x = Inf, y = Inf, show.legend = TRUE) +"
"0","  "
"0","  # Color gradient"
"0","  scale_color_viridis(option = ""viridis"", name = ""Log Loss"", direction = -1) +"
"0","  # Add shape and line legends manually"
"0","  scale_shape_manual(name = """", values = c(""Trial Log Loss"" = 16)) +"
"0","  scale_linetype_manual(name = """", values = c(""Best Model"" = ""solid"")) +"
"0",""
"0","  guides("
"0","    color = guide_colorbar(order = 1),"
"0","    shape = guide_legend("
"0","      override.aes = list(color = ""black"", size = 3), "
"0","      order = 2"
"0","    ),"
"0","    linetype = guide_legend("
"0","      override.aes = list(color = ""red"", size = 1),"
"0","      order = 3"
"0","    )"
"0","  ) +"
"0",""
"0","  scale_x_continuous("
"0","    limits = c(1, max(results_df$Trial)),"
"0","    breaks = pretty(results_df$Trial)"
"0","  ) +"
"0","  labs("
"0","    title = ""Optimization of Tuning Parameters"","
"0","    x = ""Iteration"","
"0","    y = ""Multiclass Log Loss"""
"0","  ) +"
"0","  theme_minimal(base_size = 14) +"
"0","  theme("
"0","    plot.title = element_text(size = 20, face = ""bold""),"
"0","    legend.position = ""right"""
"0","  )"
"0",""
"0","p2"
