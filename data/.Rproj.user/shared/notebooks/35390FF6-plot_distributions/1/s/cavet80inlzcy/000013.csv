"0",""
"0","# Reshape data to long format"
"0","long_dat <- full_dat %>%"
"0","  select( bpm_y_scr_internal_t, cbcl_scr_syn_internal_t) %>%"
"0","  pivot_longer(cols = everything(), names_to = ""variable"", values_to = ""value"") %>%"
"0","  mutate(variable = recode(variable,"
"0","    ""bpm_y_scr_internal_t""    = ""Youth-Reported"","
"0","    ""cbcl_scr_syn_internal_t"" = ""Parent-Reported"""
"0","  ))"
"0",""
"0","# Function to calculate density and get max y-value"
"0","calculate_density_and_max <- function(data) {"
"0","  dens <- density(data$value, na.rm = TRUE)"
"0","  return(max(dens$y))"
"0","}"
"0",""
"0","# Calculate global max density for fixed y-axis"
"0","max_density <- long_dat %>%"
"0","  group_by(variable) %>%"
"0","  summarise(max_density = calculate_density_and_max(cur_data())) %>%"
"0","  summarise(global_max = max(max_density)) %>%"
"0","  pull(global_max)"
"0",""
"0","p <- ggplot(long_dat, aes(x = value, fill = variable)) +"
"0","  geom_histogram(aes(y = ..density..), bins = 30, color = ""black"", alpha = 0.3) +"
"0","  geom_density(alpha = 0.6) +"
"0","  facet_wrap(~ variable, scales = ""fixed"") +"
"0","  labs("
"0","    title = ""Distribution of Internalizing Symptom Scores"","
"0","    x = ""T-Score"","
"0","    y = ""Density"""
"0","  ) +"
"0","  scale_fill_manual(values = c(""#2E8B57"", ""#800080"")) +"
"0","  theme_classic(base_size = 14) +"
"0","  theme("
"0","    legend.position = ""none"","
"0","    strip.text = element_text(face = ""bold"")"
"0","  )"
"0","p"
