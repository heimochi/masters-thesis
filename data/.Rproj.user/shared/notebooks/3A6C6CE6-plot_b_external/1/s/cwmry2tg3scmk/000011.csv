"0","#plot all together "
"0","class_names <- c(""0"" = ""Healthy"", ""1"" = ""Borderline"", ""2"" = ""Clinical"")"
"0","plots <- lapply(class_labels, function(cls) {"
"0","  df_cls <- df_long %>% filter(class == cls)"
"0","  cls_label <- class_names[as.character(cls)]"
"0","  "
"0","  # Histogram"
"0","  hist_plot <- ggplot(df_cls, aes(x = prob, fill = factor(is_true_class))) +"
"0","    geom_histogram(position = ""identity"", alpha = 0.8, bins = 30, color = ""black"") +"
"0","    scale_fill_manual("
"0","      values = c(""0"" = ""red"", ""1"" = ""#800080""),"
"0","      name = """","
"0","      labels = c(""Rest"", paste(""Class:"", cls_label))"
"0","    ) +"
"0","    labs("
"0","      x = paste0(""P(x = "", cls_label, "")""),"
"0","      y = ""Count"","
"0","      title = cls_label"
"0","    ) +"
"0","    theme_classic(base_size = 13) +"
"0","    theme("
"0","      plot.title = element_text(hjust = 0.5),"
"0","      legend.position = ""top"""
"0","    )"
"0","  "
"0","  # ROC"
"0","  roc_obj <- roc(df_cls$is_true_class, df_cls$prob, quiet = TRUE)"
"0","  roc_df <- data.frame("
"0","    FPR = 1 - roc_obj$specificities,"
"0","    TPR = roc_obj$sensitivities"
"0","  )"
"0","  roc_plot <- ggplot(roc_df, aes(x = FPR, y = TPR)) +"
"0","    geom_line(color = ""blue"", size = 1) +"
"0","    geom_abline(slope = 1, intercept = 0, linetype = ""dashed"", color = ""darkgreen"") +"
"0","    labs("
"0","      x = ""False Positive Rate"","
"0","      y = ""True Positive Rate"","
"0","      title = ""ROC Curve OvR"""
"0","    ) +"
"0","    theme_minimal(base_size = 13) +"
"0","    theme("
"0","      plot.title = element_text(hjust = 0.5)"
"0","    )"
"0","  "
"0","  # Combine histogram + ROC"
"0","  hist_plot / roc_plot"
"0","})"
"0",""
"0","final_plot <- wrap_plots(plots, nrow = 1)"
"0","print(final_plot)"
