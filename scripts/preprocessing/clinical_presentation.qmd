---
title: "Demographic characteristics"
author: "MochiBear.Hei"
date: "12.20.2024"
format:
  html:
    toc: true
    toc-location: left
    embed-resources: true
    page-layout: full
    html-math-method: katex
editor: source
---

```{css, echo = F}
body{
  font-family: Helvetica;
  font-size: 16pt;
  max-width: 1000px;
  margin: auto;
  margin-left:310px;
}
pre{
  font-size: 14px;
}
/* Headers */
h1{
    font-size: 24pt;
  }
h1,h2{
    font-size: 20pt;
  }
h3,h4,h5,h6{
  font-size: 18pt;
}
#TOC {
  position: fixed;
  left: 0;
  top: 0;
  width: 300px;
  height: 100%;
  overflow:auto;
}
```


```{r setup,suppressPackageStartupMessages= TRUE}
#| include: false
#| message: false
#| warning: false
#| results: hide
knitr::opts_chunk$set(echo = TRUE, dpi = 300)

# Data manipulation
library(dplyr)
library(tidyr)

# Plotting
library(ggplot2)

# Utilities
library(knitr)

library(gt)
library(epitools)
```

# Comorbid Conditions
Report on any other diagnosed mental health conditions that are prevalent within the sample

Clinical diagnosis

# KSADS
```{r}
all_ksads_diagnosis <- read.csv("/Users/maggieheimvik/Desktop/LCBC/Data/ABCD/core/mental-health/mh_p_ksads_ss.csv")

#how many?
unique_count <- length(unique(all_ksads_diagnosis$src_subject_id))
cat("Number of unique src_subject_id:", unique_count, "\n")

count_per_event <- table(all_ksads_diagnosis$eventname)
print(count_per_event)

#Keep the relevant time points
all_ksads_diagnosis <- all_ksads_diagnosis %>%
  filter(eventname == "2_year_follow_up_y_arm_1")

#only present or current diagnosis year 2
all_ksads_diagnosis <- all_ksads_diagnosis %>%
  select(
    src_subject_id, 
    ksads_11_917_p,  # Present diagnosis OCD F42
    # ADHD
    ksads_14_853_p,  #Attention-Deficit/Hyperactivity Disorder Present
    ksads_14_856_p,  #Diagnosis - Unspecified Attention-Deficit/Hyperactivity Disorder (F90.9)
    # Bipolar disorders
    ksads_2_830_p,   # Bipolar I Disorder, current episode manic (F31.1x)
    ksads_2_831_p,   # Bipolar I Disorder, current episode depressed, F31.3x
    ksads_2_835_p,   # Bipolar II Disorder, currently hypomanic F31.81
    ksads_2_832_p,   # Bipolar I Disorder, currently hypomanic F31.0
    ksads_2_833_p,   # Bipolar I Disorder, most recent past episode manic (F31.1x)
    ksads_2_834_p,   # Bipolar I Disorder, most recent past episode depressed (F31.1.3x)
    ksads_2_836_p,   # Bipolar II Disorder, Currently Depressed F31.81
    ksads_2_837_p,   # Bipolar II Disorder, most recent past hypomanic F31.81
    ksads_2_838_p,   # Unspecified Bipolar and Related Disorder, current F31.9
    # Conduct disorders / ODD
    ksads_16_898_p,  # Conduct Disorder, present adolescent onset (F91.2)
    ksads_16_897_p,  # Conduct Disorder, present childhood onset (F91.1)
    ksads_15_901_p,  # Oppositional Defiant Disorder, Present F91.3
    # Depressive disorders
    ksads_1_843_p,   # Persistent Depressive Disorder (Dysthymia) F34.1
    ksads_1_840_p,   # Major Depressive Disorder Present
    ksads_1_846_p,   # Unspecified Depressive Disorder Current (F32.9)
    ksads_3_848_p,   # Disruptive Mood Dysregulation Disorder (DMDD) Current (F34.8)
    # Anxiety disorders
    ksads_6_859_p,   # Agoraphobia (F40.00) PRESENT
    ksads_10_869_p,  # Generalized Anxiety Disorder Present (F41.1)
    ksads_5_857_p,   # Panic Disorder (F41.0) PRESENT
    ksads_7_861_p,   # Separation Anxiety Disorder (F93.00) PRESENT
    ksads_8_863_p,   # Social Anxiety Disorder (F40.10) PRESENT
    # Drug use disorders
    ksads_19_891_p,  # Alcohol Use Disorder Present
    ksads_19_895_p,  # Unspecified Alcohol-Related Disorder, present (F10.99)
    ksads_20_871_p,  # Cannabis Use Disorder Present
    ksads_20_872_p,  # Stimulant Use Disorder Present: Amphetamine-type substance
    ksads_20_873_p,  # Sedative, Hypnotic or Anxiolytic Use Disorder Present
    ksads_20_874_p,  # Stimulant Use Disorder Present: Cocaine
    ksads_20_875_p,  # Opioid Use Disorder Present
    ksads_20_878_p,  # Inhalant Use Disorder Present
    ksads_20_879_p,  # Other Drugs Use Disorder Present
    ksads_20_889_p,  # Substance Use Disorder CURRENT
    ksads_20_893_p,  # Unspecified Substance Related Disorder, Present (F10.99)
    ksads_20_876_p,  # Hallucinogen Use Disorder Present
    ksads_20_877_p,  # PCP Use Disorder Present
    # Eating disorders
    ksads_13_929_p,  # Anorexia Nervosa (F50.02) Binge eating/purging subtype
    ksads_13_932_p,  # Anorexia Nervosa (F50.01) Restricting subtype, PRESENT
    ksads_13_935_p,  # Bulimia Nervosa (F50.2) PRESENT
    ksads_13_938_p,  # Binge-Eating Disorder (F50.8) CURRENT
    # PTSD
    ksads_21_921_p,  # Post-Traumatic Stress Disorder PRESENT (F43.10)
    # Suicidality
    ksads_23_945_p,  # Self Injurious Behavior without suicidal intent Present
    ksads_23_946_p,  # Suicidal ideation Passive Present
    ksads_23_947_p,  # Suicidal ideation Active non-specific Present
    ksads_23_948_p,  # Suicidal ideation Active method Present
    ksads_23_949_p,  # Suicidal ideation Active intent Present
    ksads_23_950_p,  # Suicidal ideation Active plan Present
    ksads_23_951_p,  # Preparatory Actions toward imminent Suicidal behavior Present
    ksads_23_952_p,  # Interrupted Attempt Present
    ksads_23_953_p,  # Aborted Attempt Present
    ksads_23_954_p   # Suicide Attempt Present
  ) 


all_ksads_diagnosis <- all_ksads_diagnosis %>%
  mutate(
    adhd = if_else(ksads_14_853_p == 1 | ksads_14_856_p == 1, 1, 0),
    any_bipolar = if_else(
      ksads_2_830_p == 1 | ksads_2_831_p == 1 | ksads_2_835_p == 1 | 
      ksads_2_832_p == 1 | ksads_2_833_p == 1 | ksads_2_834_p == 1 | 
      ksads_2_836_p == 1 | ksads_2_837_p == 1 | ksads_2_838_p == 1, 1, 0
    ),
    any_conduct_odd = if_else(ksads_16_898_p == 1 | ksads_16_897_p == 1 | ksads_15_901_p == 1, 1, 0),
    any_depressive_disorder = if_else(
      ksads_1_843_p == 1 | ksads_1_840_p == 1 | ksads_1_846_p == 1 | ksads_3_848_p == 1, 1, 0
    ),
    any_anxiety_disorder = if_else(
      ksads_6_859_p == 1 | ksads_10_869_p == 1 | ksads_5_857_p == 1 | 
      ksads_7_861_p == 1 | ksads_8_863_p == 1, 1, 0
    ),
    any_drug_use_disorder = if_else(
      ksads_19_891_p == 1 | ksads_19_895_p == 1 | ksads_20_871_p == 1 | 
      ksads_20_872_p == 1 | ksads_20_873_p == 1 | ksads_20_874_p == 1 | 
      ksads_20_875_p == 1 | ksads_20_878_p == 1 | ksads_20_879_p == 1 | 
      ksads_20_889_p == 1 | ksads_20_893_p == 1 | ksads_20_876_p == 1 | 
      ksads_20_877_p == 1, 1, 0
    ),
    any_eating_disorder = if_else(ksads_13_929_p == 1 | ksads_13_932_p == 1 | ksads_13_935_p == 1 | ksads_13_938_p == 1, 1, 0),
    ptsd = if_else(ksads_21_921_p == 1, 1, 0),
    any_suicidality = if_else(
      ksads_23_945_p == 1 | ksads_23_946_p == 1 | ksads_23_947_p == 1 | 
      ksads_23_948_p == 1 | ksads_23_949_p == 1 | ksads_23_950_p == 1 | 
      ksads_23_951_p == 1 | ksads_23_952_p == 1 | ksads_23_953_p == 1 | 
      ksads_23_954_p == 1, 1, 0
    )
  )

# Check
head(all_ksads_diagnosis)

##################### NO diagnosis group ###################
# Add new columns to categorize the subjects
all_ksads_diagnosis <- all_ksads_diagnosis %>%
  mutate(
    no_diagnosis = if_else(
      ksads_11_917_p == 0 & adhd == 0 & any_bipolar == 0 & any_conduct_odd == 0 &
      any_depressive_disorder == 0 & any_anxiety_disorder == 0 &
      any_drug_use_disorder == 0 & any_eating_disorder == 0 & ptsd == 0 &
      any_suicidality == 0, 1, 0
    ),
    only_ocd = if_else(
      ksads_11_917_p == 1 & adhd == 0 & any_bipolar == 0 & any_conduct_odd == 0 &
      any_depressive_disorder == 0 & any_anxiety_disorder == 0 &
      any_drug_use_disorder == 0 & any_eating_disorder == 0 & ptsd == 0 &
      any_suicidality == 0, 1, 0
    )
  )

# Filter the subjects with no diagnosis
no_diagnosis_group <- all_ksads_diagnosis %>%
  filter(no_diagnosis == 1)

# Filter the subjects with only OCD diagnosis
only_ocd_group <- all_ksads_diagnosis %>%
  filter(only_ocd == 1)

# Check the results
cat("Number of subjects with no diagnosis:", nrow(no_diagnosis_group), "\n")
head(no_diagnosis_group)

cat("Number of subjects with only OCD diagnosis:", nrow(only_ocd_group), "\n")
head(only_ocd_group)


################ How many comorbidities in OCD group #################
# Classify comorbidities and calculate total OCD
all_ksads_diagnosis <- all_ksads_diagnosis %>%
  mutate(
    comorbidities = adhd + any_bipolar + any_conduct_odd + any_depressive_disorder + 
                    any_anxiety_disorder + any_drug_use_disorder + any_eating_disorder + 
                    ptsd + any_suicidality
  ) 

# Calculate total number with OCD
total_ocd <- all_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1) %>%
  summarise(total_ocd = n())

# Find those with OCD and categorize by comorbidities
ocd_with_comorbidities <- all_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1) %>%
  mutate(
    comorbidity_group = case_when(
      comorbidities == 0 ~ "0 comorbidities",
      comorbidities == 1 ~ "1 comorbidity",
      comorbidities == 2 ~ "2 comorbidities",
      comorbidities >= 3 ~ "3 or more comorbidities"
    )
  )

# Count subjects in each category
ocd_comorbidity_counts <- ocd_with_comorbidities %>%
  group_by(comorbidity_group) %>%
  summarise(count = n())

# Display results
cat("Total number of subjects with OCD:", total_ocd$total_ocd, "\n")
print(ocd_comorbidity_counts)

# Find those with no OCD and categorize by comorbidities
no_ocd_with_comorbidities <- all_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1) %>%
  mutate(
    comorbidity_group = case_when(
      comorbidities == 0 ~ "0 comorbidities",
      comorbidities == 1 ~ "1 comorbidity",
      comorbidities == 2 ~ "2 comorbidities",
      comorbidities >= 3 ~ "3 or more comorbidities"
    )
  )

# Count subjects in each category
no_ocd_comorbidity_counts <- no_ocd_with_comorbidities %>%
  group_by(comorbidity_group) %>%
  summarise(count = n())

# Display results
print(no_ocd_comorbidity_counts)

```

## Load
```{r}

all_ksads_diagnosis <- read.csv("/Users/maggieheimvik/Desktop/LCBC/Data/ABCD/OCD/all_ksads_diagnosis.csv")

# Filter to select only the specified columns
filtered_ksads_diagnosis <- all_ksads_diagnosis %>%
  select(
    src_subject_id,
    ksads_11_917_p,
    adhd,
    any_bipolar,
    any_conduct_odd,
    any_depressive_disorder,
    any_anxiety_disorder,
    any_drug_use_disorder,
    any_eating_disorder,
    ptsd,
    any_suicidality,
    no_diagnosis,
    only_ocd,
    comorbidities
  ) %>%
  filter(!is.na(ksads_11_917_p))

#how many in the full sample?
# Calculate the total number of unique src_subject_id
total_unique_subjects <- filtered_ksads_diagnosis %>%
  summarise(total_unique_subjects = n_distinct(src_subject_id)) %>%
  pull(total_unique_subjects)

# Display the result
cat("Total number of unique src_subject_id:", total_unique_subjects, "\n")


## how many with no ocd
# Calculate the total number of people with OCD absent
total_ocd_absent <- all_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1) %>% # Filter for cases where OCD is absent
  summarise(total_ocd_absent = n_distinct(src_subject_id)) %>%
  pull(total_ocd_absent)

# Display the result
cat("Total number of people with OCD absent:", total_ocd_absent, "\n")


```

##Check individually
Depressive disorders 
```{r}
# Total number of people in the full sample with any depressive disorder
total_depressive_disorder_full <- filtered_ksads_diagnosis %>%
  filter(any_depressive_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any depressive disorder
total_depressive_disorder_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, any_depressive_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any depressive disorder
total_depressive_disorder_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, any_depressive_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with any depressive disorder:", total_depressive_disorder_full, "\n")
cat("Total number of people with OCD and any depressive disorder:", total_depressive_disorder_ocd_present, "\n")
cat("Total number of people without OCD and with any depressive disorder:", total_depressive_disorder_ocd_absent, "\n")

```

Anxiety disorders
```{r}
# Total number of people in the full sample with any anxiety disorder
total_anxiety_disorder_full <- filtered_ksads_diagnosis %>%
  filter(any_anxiety_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any anxiety disorder
total_anxiety_disorder_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, any_anxiety_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any anxiety disorder
total_anxiety_disorder_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, any_anxiety_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with any anxiety disorder:", total_anxiety_disorder_full, "\n")
cat("Total number of people with OCD and any anxiety disorder:", total_anxiety_disorder_ocd_present, "\n")
cat("Total number of people without OCD and with any anxiety disorder:", total_anxiety_disorder_ocd_absent, "\n")

```

ADHD
```{r}
# Total number of people in the full sample with any anxiety disorder
total_adhd_full <- filtered_ksads_diagnosis %>%
  filter(adhd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any anxiety disorder
total_adhd_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, adhd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any anxiety disorder
total_adhd_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, adhd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with adhd:", total_adhd_full, "\n")
cat("Total number of people with OCD and adhd:", total_adhd_ocd_present, "\n")
cat("Total number of people without OCD and adhd:", total_adhd_ocd_absent, "\n")
```

ODD /CD
any_conduct_odd
```{r}
# Total number of people in the full sample with any anxiety disorder
total_odd_full <- filtered_ksads_diagnosis %>%
  filter(any_conduct_odd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any anxiety disorder
total_odd_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, any_conduct_odd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any anxiety disorder
total_odd_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, any_conduct_odd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with odd:", total_odd_full, "\n")
cat("Total number of people with OCD and odd:", total_odd_ocd_present, "\n")
cat("Total number of people without OCD and odd:", total_odd_ocd_absent, "\n")
```

PTSD
ptsd
```{r}
# Total number of people in the full sample with any anxiety disorder
total_ptsd_full <- filtered_ksads_diagnosis %>%
  filter(ptsd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any anxiety disorder
total_ptsd_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, ptsd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any anxiety disorder
total_ptsd_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, ptsd == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with ptsd:", total_ptsd_full, "\n")
cat("Total number of people with OCD and ptsd:", total_ptsd_ocd_present, "\n")
cat("Total number of people without OCD and ptsd:", total_ptsd_ocd_absent, "\n")
```

Drug use disorder
"any_drug_use_disorder" 
```{r}
# Total number of people in the full sample with any anxiety disorder
total_any_drug_use_disorder_full <- filtered_ksads_diagnosis %>%
  filter(any_drug_use_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any anxiety disorder
total_any_drug_use_disorder_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, any_drug_use_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any anxiety disorder
total_any_drug_use_disorder_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, any_drug_use_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with any_drug_use_disorder:", total_any_drug_use_disorder_full, "\n")
cat("Total number of people with OCD and any_drug_use_disorder:", total_any_drug_use_disorder_ocd_present, "\n")
cat("Total number of people without OCD and any_drug_use_disorder:", total_any_drug_use_disorder_ocd_absent, "\n")
```

Bipolar
"any_bipolar" 
```{r}
# Total number of people in the full sample with any anxiety disorder
total_any_bipolar_full <- filtered_ksads_diagnosis %>%
  filter(any_bipolar == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any anxiety disorder
total_any_bipolar_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, any_bipolar == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any anxiety disorder
total_any_bipolar_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, any_bipolar == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with any_bipolar:", total_any_bipolar_full, "\n")
cat("Total number of people with OCD and any_bipolar:", total_any_bipolar_ocd_present, "\n")
cat("Total number of people without OCD and any_bipolar:", total_any_bipolar_ocd_absent, "\n")
```

Eating disorder
"any_eating_disorder"
```{r}
# Total number of people in the full sample with any anxiety disorder
total_any_eating_disorder_full <- filtered_ksads_diagnosis %>%
  filter(any_eating_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any anxiety disorder
total_any_eating_disorder_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, any_eating_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any anxiety disorder
total_any_eating_disorder_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, any_eating_disorder == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with any_eating_disorder:", total_any_eating_disorder_full, "\n")
cat("Total number of people with OCD and any_eating_disorder:", total_any_eating_disorder_ocd_present, "\n")
cat("Total number of people without OCD and any_eating_disorder:", total_any_eating_disorder_ocd_absent, "\n")
```

Suicidality
"any_suicidality"  
```{r}
# Total number of people in the full sample with any anxiety disorder
total_any_suicidality_full <- filtered_ksads_diagnosis %>%
  filter(any_suicidality == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with any anxiety disorder
total_any_suicidality_ocd_present <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p == 1, any_suicidality == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD absent sample with any anxiety disorder
total_any_suicidality_ocd_absent <- filtered_ksads_diagnosis %>%
  filter(ksads_11_917_p != 1, any_suicidality == 1) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Display the results
cat("Total number of people in the full sample with any_suicidality:", total_any_suicidality_full, "\n")
cat("Total number of people with OCD and any_suicidality:", total_any_suicidality_ocd_present, "\n")
cat("Total number of people without OCD and any_suicidality:", total_any_suicidality_ocd_absent, "\n")
```
No diagnosis
```{r}
# Defining a helper function to calculate totals based on specified conditions
calculate_total <- function(data, ocd_condition) {
  data %>%
    filter(
      ksads_11_917_p == ocd_condition,
      adhd == 0,
      any_bipolar == 0,
      any_conduct_odd == 0,
      any_depressive_disorder == 0,
      any_anxiety_disorder == 0,
      any_drug_use_disorder == 0,
      any_eating_disorder == 0,
      ptsd == 0,
      any_suicidality == 0
    ) %>%
    summarise(total = n_distinct(src_subject_id)) %>%
    pull(total)
}

# Total number of people in the full sample with no diagnosis
total_no_diagnosis_full <- filtered_ksads_diagnosis %>%
  filter(
    adhd == 0,
    any_bipolar == 0,
    any_conduct_odd == 0,
    any_depressive_disorder == 0,
    any_anxiety_disorder == 0,
    any_drug_use_disorder == 0,
    any_eating_disorder == 0,
    ptsd == 0,
    any_suicidality == 0
  ) %>%
  summarise(total = n_distinct(src_subject_id)) %>%
  pull(total)

# Total number of people in the OCD present sample with no other diagnosis
total_no_other_diagnosis_ocd_present <- calculate_total(filtered_ksads_diagnosis, 1)

# Total number of people in the OCD absent sample with no diagnosis
total_no_diagnosis_ocd_absent <- calculate_total(filtered_ksads_diagnosis, 0)

# Display the results
cat("Total number of people in the full sample with no diagnosis:", total_no_diagnosis_full, "\n")
cat("Total number of people with OCD and no other diagnosis:", total_no_other_diagnosis_ocd_present, "\n")
cat("Total number of people without OCD and no diagnosis:", total_no_diagnosis_ocd_absent, "\n")
```

## OCD comorbidity
```{r}
# Define the given totals
total_full_sample <- 10756
total_ocd_absent <- 10068
total_ocd_present <- 662

# Calculate the total number of subjects for each diagnostic category in the full sample
total_per_diagnostic_category <- filtered_ksads_diagnosis %>%
  pivot_longer(
    cols = c(adhd, any_bipolar, any_conduct_odd, any_depressive_disorder,
             any_anxiety_disorder, any_drug_use_disorder, any_eating_disorder,
             ptsd, any_suicidality),
    names_to = "comorbidity",
    values_to = "diagnosis_present"
  ) %>%
  group_by(comorbidity) %>%
  summarise(total_in_full_sample = sum(diagnosis_present, na.rm = TRUE)) %>%
  ungroup()

# Create a summary for comorbidity with OCD for each diagnostic category
ocd_summary <- filtered_ksads_diagnosis %>%
  mutate(has_ocd = if_else(ksads_11_917_p == 1, "OCD", "No OCD")) %>%
  pivot_longer(
    cols = c(adhd, any_bipolar, any_conduct_odd, any_depressive_disorder,
             any_anxiety_disorder, any_drug_use_disorder, any_eating_disorder,
             ptsd, any_suicidality),
    names_to = "comorbidity",
    values_to = "diagnosis_present"
  ) %>%
  filter(diagnosis_present == 1) %>%
  group_by(comorbidity, has_ocd) %>%
  summarise(count = n(), .groups = "drop") %>%
  left_join(total_per_diagnostic_category, by = "comorbidity") %>%
  mutate(
    percentage_with_ocd = if_else(has_ocd == "OCD", (count / total_ocd_present) * 100, NA_real_),
    percentage_without_ocd = if_else(has_ocd == "No OCD", (count / total_ocd_absent) * 100, NA_real_)
  )

# View the summarized data
print(ocd_summary)

```


```{r}
# Define the given totals
total_full_sample <- 10756
total_ocd_absent <- 10068
total_ocd_present <- 662

# Filter to select only the specified columns
filtered_ksads_diagnosis <- all_ksads_diagnosis %>%
  select(
    src_subject_id,
    ksads_11_917_p,
    adhd,
    any_bipolar,
    any_conduct_odd,
    any_depressive_disorder,
    any_anxiety_disorder,
    any_drug_use_disorder,
    any_eating_disorder,
    ptsd,
    any_suicidality,
    no_diagnosis,
    only_ocd,
    comorbidities
  ) %>%
  filter(!is.na(ksads_11_917_p))

# Calculate the total number of subjects for each diagnostic category in the full sample
total_per_diagnostic_category <- filtered_ksads_diagnosis %>%
  pivot_longer(
    cols = c(adhd, any_bipolar, any_conduct_odd, any_depressive_disorder,
             any_anxiety_disorder, any_drug_use_disorder, any_eating_disorder,
             ptsd, any_suicidality),
    names_to = "comorbidity",
    values_to = "diagnosis_present"
  ) %>%
  group_by(comorbidity) %>%
  summarise(
    total_in_full_sample = sum(diagnosis_present, na.rm = TRUE),
    percentage_full_sample = (total_in_full_sample / total_full_sample) * 100
  ) %>%
  ungroup()

# Create a summary for comorbidity with OCD for each diagnostic category
ocd_summary <- filtered_ksads_diagnosis %>%
  mutate(has_ocd = if_else(ksads_11_917_p == 1, "OCD", "No OCD")) %>%
  pivot_longer(
    cols = c(adhd, any_bipolar, any_conduct_odd, any_depressive_disorder,
             any_anxiety_disorder, any_drug_use_disorder, any_eating_disorder,
             ptsd, any_suicidality),
    names_to = "comorbidity",
    values_to = "diagnosis_present"
  ) %>%
  filter(diagnosis_present == 1) %>%
  group_by(comorbidity, has_ocd) %>%
  summarise(count = n(), .groups = "drop") %>%
  left_join(total_per_diagnostic_category, by = "comorbidity") %>%
  mutate(
    percentage_with_ocd = if_else(has_ocd == "OCD", (count / total_ocd_present) * 100, NA_real_),
    percentage_without_ocd = if_else(has_ocd == "No OCD", (count / total_ocd_absent) * 100, NA_real_)
  )

full_summary <- total_per_diagnostic_category %>%
  select(comorbidity, percentage_full_sample)

ocd_absent_summary <- ocd_summary %>%
  filter(has_ocd == "No OCD") %>%
  select(comorbidity, percentage_without_ocd)

ocd_present_summary <- ocd_summary %>%
  filter(has_ocd == "OCD") %>%
  select(comorbidity, percentage_with_ocd)

final_summary <- full_summary %>%
  left_join(ocd_absent_summary, by = "comorbidity") %>%
  left_join(ocd_present_summary, by = "comorbidity")

# View the summarized data
print(final_summary)
```

```{r}
# Create a new variable to mark OCD presence
filtered_ksads_diagnosis <- filtered_ksads_diagnosis %>%
  mutate(has_ocd = if_else(ksads_11_917_p == 1, "OCD", "No OCD"))

# Contingency table and chi-squared test for each disorder
disorders <- c("adhd", "any_bipolar", "any_conduct_odd", "any_depressive_disorder",
               "any_anxiety_disorder", "any_drug_use_disorder", "any_eating_disorder",
               "ptsd", "any_suicidality")

# This will store the results
chi_squared_results <- list()

for (disorder in disorders) {
  contingency_table <- table(filtered_ksads_diagnosis[[disorder]], filtered_ksads_diagnosis$has_ocd)
  chi_test <- chisq.test(contingency_table)
  chi_squared_results[[disorder]] <- list(
    table = contingency_table,
    p_value = chi_test$p.value,
    chi_squared = chi_test$statistic
  )
  cat("\n=== Results for", disorder, "===\n")
  print(contingency_table)
  cat("Chi-squared statistic:", chi_test$statistic, "\n")
  cat("p-value:", chi_test$p.value, "\n")
}

# To access results for a specific disorder, you can use chi_squared_results[["disorder_name"]]
# For example, chi_squared_results[["adhd"]] will give the results for ADHD
```

```{r}
# Create a new variable to mark OCD presence
filtered_ksads_diagnosis <- filtered_ksads_diagnosis %>%
  mutate(has_ocd = if_else(ksads_11_917_p == 1, "OCD", "No OCD"))

# Add "no_diagnosis" to the list of disorders
disorders <- c("adhd", "any_bipolar", "any_conduct_odd", "any_depressive_disorder",
               "any_anxiety_disorder", "any_drug_use_disorder", "any_eating_disorder",
               "ptsd", "any_suicidality", "no_diagnosis")

# Store the results
chi_squared_results <- list()

# Perform contingency table and chi-squared test
for (disorder in disorders) {
  contingency_table <- table(filtered_ksads_diagnosis[[disorder]], filtered_ksads_diagnosis$has_ocd)
  chi_test <- chisq.test(contingency_table)
  chi_squared_results[[disorder]] <- list(
    table = contingency_table,
    p_value = chi_test$p.value,
    chi_squared = chi_test$statistic
  )
  cat("\n=== Results for", disorder, "===\n")
  print(contingency_table)
  cat("Chi-squared statistic:", chi_test$statistic, "\n")
  cat("p-value:", chi_test$p.value, "\n")
}

# Calculate percentages including "no_diagnosis"
diagnosis_summary <- filtered_ksads_diagnosis %>%
  select(has_ocd, no_diagnosis) %>%
  group_by(has_ocd) %>%
  summarise(
    no_diagnosis_count = sum(no_diagnosis, na.rm = TRUE),
    percentage = no_diagnosis_count / n() * 100
  ) %>%
  ungroup()

# Calculate full sample percentages separately
full_sample_no_diagnosis <- sum(filtered_ksads_diagnosis$no_diagnosis, na.rm = TRUE)
full_sample_percentage <- (full_sample_no_diagnosis / total_full_sample) * 100

# Add summary for full sample
diagnosis_summary <- diagnosis_summary %>%
  add_row(has_ocd = "Full Sample", no_diagnosis_count = full_sample_no_diagnosis, percentage = full_sample_percentage)

# View the 'No Diagnosis' summary data
print(diagnosis_summary)

```
```{r}

library(epiR) # For calculating odds ratio

# Create a new variable to mark OCD presence
filtered_ksads_diagnosis <- filtered_ksads_diagnosis %>%
  mutate(has_ocd = if_else(ksads_11_917_p == 1, "OCD", "No OCD"))

# Add "no_diagnosis" to the list of disorders
disorders <- c("adhd", "any_bipolar", "any_conduct_odd", "any_depressive_disorder",
               "any_anxiety_disorder", "any_drug_use_disorder", "any_eating_disorder",
               "ptsd", "any_suicidality", "no_diagnosis")

# Store the results
chi_squared_results <- list()
odds_ratios <- data.frame(Disorder = character(), OR = numeric(), Lower_CI = numeric(), Upper_CI = numeric(), stringsAsFactors = FALSE)

# Perform contingency table and calculate chi-squared and odds ratio
for (disorder in disorders) {
  contingency_table <- table(filtered_ksads_diagnosis[[disorder]], filtered_ksads_diagnosis$has_ocd)
  chi_test <- chisq.test(contingency_table)
  
  # Calculate odds ratio using epiR package, handling cases where odds ratio cannot be computed
  if (all(contingency_table > 0)) { # Only calculate OR if no zero counts
    or_result <- epi.2by2(contingency_table, method = "cohort.count")
    or_value <- as.numeric(or_result$measure[1, "est"])
    lower_ci <- as.numeric(or_result$measure[1, "lower"])
    upper_ci <- as.numeric(or_result$measure[1, "upper"])
    
    odds_ratios <- rbind(odds_ratios, data.frame(
      Disorder = disorder,
      OR = or_value,
      Lower_CI = lower_ci,
      Upper_CI = upper_ci
    ))
  } else {
    or_value <- NA
    lower_ci <- NA
    upper_ci <- NA
  }
  
  chi_squared_results[[disorder]] <- list(
    table = contingency_table,
    p_value = chi_test$p.value,
    chi_squared = chi_test$statistic
  )
  
  cat("\n=== Results for", disorder, "===\n")
  print(contingency_table)
  cat("Chi-squared statistic:", chi_test$statistic, "\n")
  cat("p-value:", chi_test$p.value, "\n")
  if (!is.na(or_value)) {
    cat("Odds Ratio:", or_value, "\n")
    cat("95% CI: [", lower_ci, ", ", upper_ci, "]\n")
  } else {
    cat("Odds Ratio: Unable to calculate due to zero counts\n")
  }
}

# Print Odds Ratios Summary
print(odds_ratios)

```

# CBCL
```{r}
dsm_diagnosis <- read.csv("/Users/maggieheimvik/Desktop/LCBC/Data/ABCD/ocd/p_data.csv")

dsm_diagnosis <- dsm_diagnosis %>%
  select(src_subject_id, cbcl_scr_syn_attention_t, cbcl_scr_dsm5_anxdisord_t, cbcl_scr_dsm5_adhd_t, cbcl_scr_dsm5_depress_t, cbcl_scr_dsm5_somaticpr_t, cbcl_scr_dsm5_opposit_t, cbcl_scr_dsm5_conduct_t, cbcl_scr_syn_internal_t, cbcl_scr_syn_external_t, cbcl_scr_syn_totprob_t, cbcl_scr_07_ocd_t)
```

Merge DSM diagnosis with OCD diagnosis
```{r}
ocd_presence_ksads <- filtered_ksads_diagnosis %>%
  select(src_subject_id, ksads_11_917_p)
  
# Merge datasets by src_subject_id
dsm_diagnosis <- ocd_presence_ksads %>%
  inner_join(dsm_diagnosis, by = "src_subject_id")

#how many in the full sample?
# Calculate the total number of unique src_subject_id
total_unique_subjects <- dsm_diagnosis %>%
  summarise(total_unique_subjects = n_distinct(src_subject_id)) %>%
  pull(total_unique_subjects)

# Display the result
cat("Total number of unique src_subject_id:", total_unique_subjects, "\n")


## how many with no ocd
# Calculate the total number of people with OCD absent
total_ocd_absent <- dsm_diagnosis %>%
  filter(ksads_11_917_p != 1) %>% # Filter for cases where OCD is absent
  summarise(total_ocd_absent = n_distinct(src_subject_id)) %>%
  pull(total_ocd_absent)

# Display the result
cat("Total number of people with OCD absent:", total_ocd_absent, "\n")

## how many with ocd
# Calculate the total number of people with OCD absent
total_ocd_present <- dsm_diagnosis %>%
  filter(ksads_11_917_p == 1) %>% # Filter for cases where OCD is absent
  summarise(total_ocd_present = n_distinct(src_subject_id)) %>%
  pull(total_ocd_present)

# Display the result
cat("Total number of people with OCD present:", total_ocd_present, "\n")


```

## DSM comorbidity
```{r}

# Full dataset statistics for each T score category
full_sample_stats <- dsm_diagnosis %>%
  summarise(
    mean_attention_t = mean(cbcl_scr_syn_attention_t, na.rm = TRUE),
    sd_attention_t = sd(cbcl_scr_syn_attention_t, na.rm = TRUE),
    mean_anxdisord_t = mean(cbcl_scr_dsm5_anxdisord_t, na.rm = TRUE),
    sd_anxdisord_t = sd(cbcl_scr_dsm5_anxdisord_t, na.rm = TRUE),
    mean_adhd_t = mean(cbcl_scr_dsm5_adhd_t, na.rm = TRUE),
    sd_adhd_t = sd(cbcl_scr_dsm5_adhd_t, na.rm = TRUE),
    mean_depress_t = mean(cbcl_scr_dsm5_depress_t, na.rm = TRUE),
    sd_depress_t = sd(cbcl_scr_dsm5_depress_t, na.rm = TRUE),
    mean_somaticpr_t = mean(cbcl_scr_dsm5_somaticpr_t, na.rm = TRUE),
    sd_somaticpr_t = sd(cbcl_scr_dsm5_somaticpr_t, na.rm = TRUE),
    mean_opposit_t = mean(cbcl_scr_dsm5_opposit_t, na.rm = TRUE),
    sd_opposit_t = sd(cbcl_scr_dsm5_opposit_t, na.rm = TRUE),
    mean_conduct_t = mean(cbcl_scr_dsm5_conduct_t, na.rm = TRUE),
    sd_conduct_t = sd(cbcl_scr_dsm5_conduct_t, na.rm = TRUE),
    mean_internal_t = mean(cbcl_scr_syn_internal_t, na.rm = TRUE),
    sd_internal_t = sd(cbcl_scr_syn_internal_t, na.rm = TRUE),
    mean_external_t = mean(cbcl_scr_syn_external_t, na.rm = TRUE),
    sd_external_t = sd(cbcl_scr_syn_external_t, na.rm = TRUE),
    mean_totprob_t = mean(cbcl_scr_syn_totprob_t, na.rm = TRUE),
    sd_totprob_t = sd(cbcl_scr_syn_totprob_t, na.rm = TRUE),
    mean_ocd_t = mean(cbcl_scr_07_ocd_t, na.rm = TRUE),
    sd_ocd_t = sd(cbcl_scr_07_ocd_t, na.rm = TRUE)
  )

# Statistics for OCD present population
ocd_present_stats <- dsm_diagnosis %>%
  filter(ksads_11_917_p == 1) %>%
  summarise(
    mean_attention_t = mean(cbcl_scr_syn_attention_t, na.rm = TRUE),
    sd_attention_t = sd(cbcl_scr_syn_attention_t, na.rm = TRUE),
    mean_anxdisord_t = mean(cbcl_scr_dsm5_anxdisord_t, na.rm = TRUE),
    sd_anxdisord_t = sd(cbcl_scr_dsm5_anxdisord_t, na.rm = TRUE),
    mean_adhd_t = mean(cbcl_scr_dsm5_adhd_t, na.rm = TRUE),
    sd_adhd_t = sd(cbcl_scr_dsm5_adhd_t, na.rm = TRUE),
    mean_depress_t = mean(cbcl_scr_dsm5_depress_t, na.rm = TRUE),
    sd_depress_t = sd(cbcl_scr_dsm5_depress_t, na.rm = TRUE),
    mean_somaticpr_t = mean(cbcl_scr_dsm5_somaticpr_t, na.rm = TRUE),
    sd_somaticpr_t = sd(cbcl_scr_dsm5_somaticpr_t, na.rm = TRUE),
    mean_opposit_t = mean(cbcl_scr_dsm5_opposit_t, na.rm = TRUE),
    sd_opposit_t = sd(cbcl_scr_dsm5_opposit_t, na.rm = TRUE),
    mean_conduct_t = mean(cbcl_scr_dsm5_conduct_t, na.rm = TRUE),
    sd_conduct_t = sd(cbcl_scr_dsm5_conduct_t, na.rm = TRUE),
    mean_internal_t = mean(cbcl_scr_syn_internal_t, na.rm = TRUE),
    sd_internal_t = sd(cbcl_scr_syn_internal_t, na.rm = TRUE),
    mean_external_t = mean(cbcl_scr_syn_external_t, na.rm = TRUE),
    sd_external_t = sd(cbcl_scr_syn_external_t, na.rm = TRUE),
    mean_totprob_t = mean(cbcl_scr_syn_totprob_t, na.rm = TRUE),
    sd_totprob_t = sd(cbcl_scr_syn_totprob_t, na.rm = TRUE),
    mean_ocd_t = mean(cbcl_scr_07_ocd_t, na.rm = TRUE),
    sd_ocd_t = sd(cbcl_scr_07_ocd_t, na.rm = TRUE)
  )

# Statistics for OCD absent population
ocd_absent_stats <- dsm_diagnosis %>%
  filter(ksads_11_917_p == 0) %>%
  summarise(
    mean_attention_t = mean(cbcl_scr_syn_attention_t, na.rm = TRUE),
    sd_attention_t = sd(cbcl_scr_syn_attention_t, na.rm = TRUE),
    mean_anxdisord_t = mean(cbcl_scr_dsm5_anxdisord_t, na.rm = TRUE),
    sd_anxdisord_t = sd(cbcl_scr_dsm5_anxdisord_t, na.rm = TRUE),
    mean_adhd_t = mean(cbcl_scr_dsm5_adhd_t, na.rm = TRUE),
    sd_adhd_t = sd(cbcl_scr_dsm5_adhd_t, na.rm = TRUE),
    mean_depress_t = mean(cbcl_scr_dsm5_depress_t, na.rm = TRUE),
    sd_depress_t = sd(cbcl_scr_dsm5_depress_t, na.rm = TRUE),
    mean_somaticpr_t = mean(cbcl_scr_dsm5_somaticpr_t, na.rm = TRUE),
    sd_somaticpr_t = sd(cbcl_scr_dsm5_somaticpr_t, na.rm = TRUE),
    mean_opposit_t = mean(cbcl_scr_dsm5_opposit_t, na.rm = TRUE),
    sd_opposit_t = sd(cbcl_scr_dsm5_opposit_t, na.rm = TRUE),
    mean_conduct_t = mean(cbcl_scr_dsm5_conduct_t, na.rm = TRUE),
    sd_conduct_t = sd(cbcl_scr_dsm5_conduct_t, na.rm = TRUE),
    mean_internal_t = mean(cbcl_scr_syn_internal_t, na.rm = TRUE),
    sd_internal_t = sd(cbcl_scr_syn_internal_t, na.rm = TRUE),
    mean_external_t = mean(cbcl_scr_syn_external_t, na.rm = TRUE),
    sd_external_t = sd(cbcl_scr_syn_external_t, na.rm = TRUE),
    mean_totprob_t = mean(cbcl_scr_syn_totprob_t, na.rm = TRUE),
    sd_totprob_t = sd(cbcl_scr_syn_totprob_t, na.rm = TRUE),
    mean_ocd_t = mean(cbcl_scr_07_ocd_t, na.rm = TRUE),
    sd_ocd_t = sd(cbcl_scr_07_ocd_t, na.rm = TRUE)
  )

# Print summaries
print("Full Sample Statistics")
print(full_sample_stats)

print("OCD Present Statistics")
print(ocd_present_stats)

print("OCD Absent Statistics")
print(ocd_absent_stats)

```
### t-test 
```{r}
# Perform t-test for each CBCL diagnostic category
t_test_results_cbcl <- dsm_diagnosis %>%
  mutate(has_ocd = if_else(ksads_11_917_p == 1, "OCD", "No OCD")) %>%
  pivot_longer(
    cols = c(cbcl_scr_dsm5_anxdisord_t, cbcl_scr_dsm5_adhd_t, cbcl_scr_dsm5_depress_t, 
             cbcl_scr_dsm5_somaticpr_t, cbcl_scr_dsm5_opposit_t, cbcl_scr_dsm5_conduct_t),
    names_to = "comorbidity",
    values_to = "score"
  ) %>%
  group_by(comorbidity) %>%
  summarise(
    t_test_result = list(t.test(score ~ has_ocd, data = .)),
    .groups = "drop"
  ) %>%
  mutate(
    p_value = map_dbl(t_test_result, ~ .x$p.value),
    t_statistic = map_dbl(t_test_result, ~ .x$statistic)
  ) %>%
  select(comorbidity, p_value, t_statistic)

# View results
print(t_test_results_cbcl)
```

### Cohens D (effect size)
```{r}

```


```{r}
# Create a function to summarize diagnoses
summarize_diagnosis <- function(data, diagnosis_col, group_col) {
  data %>%
    group_by(!!sym(group_col)) %>%
    summarise(
      n = sum(!is.na(!!sym(diagnosis_col)) & !!sym(diagnosis_col) == 1, na.rm = TRUE),
      pct = n / nrow(data) * 100
    )
}

# Example: Summarize any depressive disorder (ksads_1_840_p) by OCD presence
depressive_summary <- summarize_diagnosis(merged_diagnosis, "ksads_1_840_p", "ksads_11_917_p")


# Perform t-tests and extract p-values and statistics
cbcl_t_tests <- merged_diagnosis %>%
  summarise(
    Anxiety_mean_diff = mean(cbcl_scr_dsm5_anxdisord_t[ksads_11_917_p == 1], na.rm = TRUE) - 
                        mean(cbcl_scr_dsm5_anxdisord_t[ksads_11_917_p == 0], na.rm = TRUE),
    Depression_mean_diff = mean(cbcl_scr_dsm5_depress_t[ksads_11_917_p == 1], na.rm = TRUE) - 
                           mean(cbcl_scr_dsm5_depress_t[ksads_11_917_p == 0], na.rm = TRUE),
    Anxiety_p_value = t.test(cbcl_scr_dsm5_anxdisord_t ~ ksads_11_917_p, data = ., na.action = na.omit)$p.value,
    Depression_p_value = t.test(cbcl_scr_dsm5_depress_t ~ ksads_11_917_p, data = ., na.action = na.omit)$p.value,
    Anxiety_t_stat = t.test(cbcl_scr_dsm5_anxdisord_t ~ ksads_11_917_p, data = ., na.action = na.omit)$statistic,
    Depression_t_stat = t.test(cbcl_scr_dsm5_depress_t ~ ksads_11_917_p, data = ., na.action = na.omit)$statistic
  )

# View results
print(cbcl_t_tests)

# Format results for the table
table_data <- merged_diagnosis %>%
  summarise(
    `DSM-5 Anxiety` = paste0(
      round(mean(cbcl_scr_dsm5_anxdisord_t, na.rm = TRUE), 2), " (",
      round(sd(cbcl_scr_dsm5_anxdisord_t, na.rm = TRUE), 2), ")"
    ),
    `DSM-5 Depression` = paste0(
      round(mean(cbcl_scr_dsm5_depress_t, na.rm = TRUE), 2), " (",
      round(sd(cbcl_scr_dsm5_depress_t, na.rm = TRUE), 2), ")"
    )
  )

# Generate the Table Using gt
summary_data %>%
  gt() %>%
  tab_header(
    title = "Demographic Characteristics of the Sample"
  ) %>%
  cols_label(
    Full_Sample = "Full Sample",
    `OCD Absent` = "OCD Absent",
    `OCD Present` = "OCD Present",
    `Group Difference` = "Group Difference",
    p = "p",
    `Effect Size` = "Effect Size"
  ) %>%
  fmt_number(
    decimals = 2
  )
# Print the table
print(final_table)
```

#	OCS score
obsessive compulsive score derived from CBCL items
```{r}
ocs_score <- read.csv("/Users/maggieheimvik/Desktop/LCBC/Data/ABCD/ocd/p_data.csv")

ocs_score <- ocs_score %>%
  select(src_subject_id, ocs_score)
```



# Health variables
```{r}
health <- read.csv("/Users/maggieheimvik/Desktop/LCBC/Data/ABCD/core/physical-health/ph_p_mhx.csv") 

health <- health %>%
  select(src_subject_id, eventname, medhx_6i, medhx_6i_l, medhx_2h, medhx_6p, medhx_2h_l) %>%
  filter(eventname %in% c("baseline_year_1_arm_1", "2_year_follow_up_y_arm_1")) %>%
  mutate(
    head_injury = case_when(
      medhx_6i == 1 | medhx_6i_l == 1 ~ 1,
      TRUE ~ 0
    ),
    seizure = case_when(
      medhx_2h == 1 | medhx_6p == 1 | medhx_2h_l == 1 ~ 1,
      TRUE ~ 0
    )
  ) %>%
  select(src_subject_id, head_injury, seizure)
```

# Medication use
```{r}
medication <-  read.csv("/Users/maggieheimvik/Desktop/LCBC/Data/ABCD/core/physical-health/ph_p_meds.csv")

# Recode and simplify medication
```




```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```



